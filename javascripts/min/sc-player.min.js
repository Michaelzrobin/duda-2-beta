!function(e){var n,a,t,i=function(e){var n=function(e){return{h:Math.floor(e/36e5),m:Math.floor(e/6e4%60),s:Math.floor(e/1e3%60)}}(e),a=[];return n.h>0&&a.push(n.h),a.push(n.m<10&&n.h>0?"0"+n.m:n.m),a.push(n.s<10?"0"+n.s:n.s),a.join(".")},s=function(e){return e.sort(function(){return 1-Math.floor(3*Math.random())}),e},o=!0,r=!1,c=e(document),l=function(){try{o&&window.console&&window.console.log&&window.console.log.apply(window.console,arguments)}catch(e){}},u=r?"sandbox-soundcloud.com":"soundcloud.com",d="https:"===document.location.protocol,p=function(e,n){var a=(d||/^https/i.test(e)?"https":"http")+"://api."+u+"/resolve?url=",t="format=json&consumer_key="+n+"&callback=?";return d&&(e=e.replace(/^http:/,"https:")),/api\./.test(e)?e+"?"+t:a+e+"&"+t},f=function(){var n=function(){var e=!1;try{var n=new Audio;e=n.canPlayType&&/maybe|probably/.test(n.canPlayType("audio/mpeg"))}catch(a){}return e}(),a={onReady:function(){c.trigger("scPlayer:onAudioReady")},onPlay:function(){c.trigger("scPlayer:onMediaPlay")},onPause:function(){c.trigger("scPlayer:onMediaPause")},onEnd:function(){c.trigger("scPlayer:onMediaEnd")},onBuffer:function(e){c.trigger({type:"scPlayer:onMediaBuffering",percent:e})}},t=function(){var n=new Audio,t=function(e){var n=e.target,t=(n.buffered.length&&n.buffered.end(0))/n.duration*100;a.onBuffer(t),n.currentTime===n.duration&&a.onEnd()},i=function(e){var n=e.target,t=(n.buffered.length&&n.buffered.end(0))/n.duration*100;a.onBuffer(t)};return e('<div class="sc-player-engine-container"></div>').appendTo(document.body).append(n),n.addEventListener("play",a.onPlay,!1),n.addEventListener("pause",a.onPause,!1),n.addEventListener("timeupdate",t,!1),n.addEventListener("progress",i,!1),{load:function(e,a){n.pause(),n.src=e.stream_url+(/\?/.test(e.stream_url)?"&":"?")+"consumer_key="+a,n.load(),n.play()},play:function(){n.play()},pause:function(){n.pause()},stop:function(){n.currentTime&&(n.currentTime=0,n.pause())},seek:function(e){n.currentTime=n.duration*e,n.play()},getDuration:function(){return 1e3*n.duration},getPosition:function(){return 1e3*n.currentTime},setVolume:function(e){n.volume=e/100}}},i=function(){var n,t="scPlayerEngine",i=function(n){var a=(d?"https":"http")+"://player."+u+"/player.swf?url="+n+"&amp;enable_api=true&amp;player_type=engine&amp;object_id="+t;return e.browser.msie?'<object height="100%" width="100%" id="'+t+'" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" data="'+a+'"><param name="movie" value="'+a+'" /><param name="allowscriptaccess" value="always" /></object>':'<object height="100%" width="100%" id="'+t+'"><embed allowscriptaccess="always" height="100%" width="100%" src="'+a+'" type="application/x-shockwave-flash" name="'+t+'" /></object>'};return soundcloud.addEventListener("onPlayerReady",function(){n=soundcloud.getPlayer(t),a.onReady()}),soundcloud.addEventListener("onMediaEnd",a.onEnd),soundcloud.addEventListener("onMediaBuffering",function(e,n){a.onBuffer(n.percent)}),soundcloud.addEventListener("onMediaPlay",a.onPlay),soundcloud.addEventListener("onMediaPause",a.onPause),{load:function(a){var t=a.uri;n?n.api_load(t):e('<div class="sc-player-engine-container"></div>').appendTo(document.body).html(i(t))},play:function(){n&&n.api_play()},pause:function(){n&&n.api_pause()},stop:function(){n&&n.api_stop()},seek:function(e){n&&n.api_seekTo(n.api_getTrackDuration()*e)},getDuration:function(){return n&&n.api_getTrackDuration&&1e3*n.api_getTrackDuration()},getPosition:function(){return n&&n.api_getTrackPosition&&1e3*n.api_getTrackPosition()},setVolume:function(e){n&&n.api_setVolume&&n.api_setVolume(e)}}};return n?t():i()}(),y=!1,v=[],h={},m=function(a,t,i){var s=0,o={node:a,tracks:[]},r=function(a){var i=p(a.url,n);e.getJSON(i,function(n){s+=1,n.tracks?o.tracks=o.tracks.concat(n.tracks):n.duration?(n.permalink_url=a.url,o.tracks.push(n)):n.creator?t.push({url:n.uri+"/tracks"}):n.username?/favorites/.test(a.url)?t.push({url:n.uri+"/favorites"}):t.push({url:n.uri+"/tracks"}):e.isArray(n)&&(o.tracks=o.tracks.concat(n)),t[s]?r(t[s]):o.node.trigger({type:"onTrackDataLoaded",playerObj:o,url:i})})};n=i,v.push(o),r(t[s])},g=function(e,n){return n?'<div class="sc-loading-artwork">Loading Artwork</div>':e.artwork_url?'<img src="'+e.artwork_url.replace("-large","-t300x300")+'"/>':'<div class="sc-no-artwork">No Artwork</div>'},k=function(n,a){e(".sc-info",n).each(function(){e("h3",this).html('<a href="'+a.permalink_url+'">'+a.title+"</a>"),e("h4",this).html('by <a href="'+a.user.permalink_url+'">'+a.user.username+"</a>"),e("p",this).html(a.description||"no Description")}),e(".sc-artwork-list li",n).each(function(){var n=e(this),t=n.data("sc-track");t===a?n.addClass("active").find(".sc-loading-artwork").each(function(){e(this).removeClass("sc-loading-artwork").html(g(a,!1))}):n.removeClass("active")}),e(".sc-duration",n).html(i(a.duration)),e(".sc-waveform-container",n).html('<img src="'+a.waveform_url+'" />'),n.trigger("onPlayerTrackSwitch.scPlayer",[a])},P=function(e){var t=e.permalink_url;a===t?f.play():(a=t,f.load(e,n))},w=function(n){return v[e(n).data("sc-player").id]},b=function(n,a){a&&e("div.sc-player.playing").removeClass("playing"),e(n).toggleClass("playing",a).trigger(a?"onPlayerPlay":"onPlayerPause")},T=function(n,a){var t=w(n).tracks[a||0];k(n,t),h={$buffer:e(".sc-buffer",n),$played:e(".sc-played",n),position:e(".sc-position",n)[0]},b(n,!0),P(t)},_=function(e){b(e,!1),f.pause()},M=function(){var e=h.$played.closest(".sc-player");h.$played.css("width","0%"),h.position.innerHTML=i(0),b(e,!1),f.stop(),e.trigger("onPlayerTrackFinish")},C=function(n,a){f.seek(a),e(n).trigger("onPlayerSeek")},E=function(n){var a=e(n);l("track finished get the next one"),$nextItem=e(".sc-trackslist li.active",a).next("li"),$nextItem.length||($nextItem=a.nextAll("div.sc-player:first").find(".sc-trackslist li.active")),$nextItem.click()},D=function(){var e=80,n=document.cookie.split(";"),a=new RegExp("scPlayer_volume=(\\d+)");for(var t in n)if(a.test(n[t])){e=parseInt(n[t].match(a)[1],10);break}return e}(),L=function(e){var n=Math.floor(e),a=new Date;a.setTime(a.getTime()+31536e6),D=n,document.cookie=["scPlayer_volume=",n,"; expires=",a.toUTCString(),'; path="/"'].join(""),f.setVolume(D)};c.bind("scPlayer:onAudioReady",function(){l("onPlayerReady: audio engine is ready"),f.play(),L(D)}).bind("scPlayer:onMediaPlay",function(){clearInterval(t),t=setInterval(function(){var e=f.getDuration(),n=f.getPosition(),a=n/e;h.$played.css("width",100*a+"%"),h.position.innerHTML=i(n),c.trigger({type:"onMediaTimeUpdate.scPlayer",duration:e,position:n,relative:a})},500)}).bind("scPlayer:onMediaPause",function(){clearInterval(t),t=null}).bind("scPlayer:onVolumeChange",function(e){L(e.volume)}).bind("scPlayer:onMediaEnd",function(){M()}).bind("scPlayer:onMediaBuffering",function(e){h.$buffer.css("width",e.percent+"%")}),e.scPlayer=function(n,a){var t=e.extend({},e.scPlayer.defaults,n),o=v.length,r=a&&e(a),c=r[0].className.replace("sc-player",""),l=t.links||e.map(e("a",r).add(r.filter("a")),function(e){return{url:e.href,title:e.innerHTML}}),u=e('<div class="sc-player loading"></div>').data("sc-player",{id:o}),d=e('<ol class="sc-artwork-list"></ol>').appendTo(u),p=(e('<div class="sc-info"><h3></h3><h4></h4><p></p><a href="#" class="sc-info-close">X</a></div>').appendTo(u),e('<div class="sc-controls"></div>').appendTo(u),e('<ol class="sc-trackslist"></ol>').appendTo(u));return(c||t.customClass)&&u.addClass(c).addClass(t.customClass),u.find(".sc-controls").append('<a href="#play" class="sc-play">Play</a> <a href="#pause" class="sc-pause sc_hidden">Pause</a>').end().append('<a href="#info" class="sc-info-toggle">Info</a>').append('<div class="sc-scrubber"></div>').find(".sc-scrubber").append('<div class="sc-volume-slider"><span class="sc-volume-status" style="width:'+D+'%"></span></div>').append('<div class="sc-time-span"><div class="sc-waveform-container"></div><div class="sc-buffer"></div><div class="sc-played"></div></div>').append('<div class="sc-time-indicators"><span class="sc-position"></span> | <span class="sc-duration"></span></div>'),m(u,l,t.apiKey),u.bind("onTrackDataLoaded.scPlayer",function(n){var a=n.playerObj.tracks;t.randomize&&(a=s(a)),e.each(a,function(n,a){var s=0===n;e('<li><a href="'+a.permalink_url+'">'+a.title+'</a><span class="sc-track-duration">'+i(a.duration)+"</span></li>").data("sc-track",{id:n}).toggleClass("active",s).appendTo(p),e("<li></li>").append(g(a,n>=t.loadArtworks)).appendTo(d).toggleClass("active",s).data("sc-track",a)}),u.each(function(){e.isFunction(t.beforeRender)&&t.beforeRender.call(this,a)}),e(".sc-duration",u)[0].innerHTML=i(a[0].duration),e(".sc-position",u)[0].innerHTML=i(0),k(u,a[0]),t.continuePlayback&&u.bind("onPlayerTrackFinish",function(){E(u)}),u.removeClass("loading").trigger("onPlayerInit"),t.autoPlay&&!y&&(T(u),y=!0)}),r.each(function(){e(this).replaceWith(u)}),u},e.scPlayer.stopAll=function(){e(".sc-player.playing a.sc-pause").click()},e.scPlayer.destroy=function(){e(".sc-player, .sc-player-engine-container").remove()},e.fn.scPlayer=function(n){return y=!1,this.each(function(){e.scPlayer(n,this)}),this},e.scPlayer.defaults=e.fn.scPlayer.defaults={customClass:null,beforeRender:function(){e(this)},onDomReady:function(){e("a.sc-player, div.sc-player").scPlayer()},autoPlay:!1,continuePlayback:!0,randomize:!1,loadArtworks:5,apiKey:"htuiRd1JP11Ww0X72T1C3g"},e(document).on("click","a.sc-play, a.sc-pause",function(){var n=e(this).closest(".sc-player").find("ol.sc-trackslist");return n.find("li.active").click(),!1}),e(document).on("click","a.sc-info-toggle, a.sc-info-close",function(){var n=e(this);return n.closest(".sc-player").find(".sc-info").toggleClass("active").end().find("a.sc-info-toggle").toggleClass("active"),!1}),e(document).on("click",".sc-trackslist li",function(){var n=e(this),a=n.closest(".sc-player"),t=n.data("sc-track").id,i=a.is(":not(.playing)")||n.is(":not(.active)");return i?T(a,t):_(a),n.addClass("active").siblings("li").removeClass("active"),e(".artworks li",a).each(function(n){e(this).toggleClass("active",n===t)}),!1});var R=function(n,a){var t=e(n).closest(".sc-time-span"),i=t.find(".sc-buffer"),s=t.find(".sc-waveform-container img"),o=t.closest(".sc-player"),r=Math.min(i.width(),a-s.offset().left)/s.width();C(o,r)},x=function(e){1===e.targetTouches.length&&(R(e.target,e.targetTouches&&e.targetTouches.length&&e.targetTouches[0].clientX),e.preventDefault())};e(document).on("click",".sc-time-span",function(e){return R(this,e.pageX),!1}).on("touchstart",".sc-time-span",function(e){this.addEventListener("touchmove",x,!1),e.originalEvent.preventDefault()}).on("touchend",".sc-time-span",function(e){this.removeEventListener("touchmove",x,!1),e.originalEvent.preventDefault()});var A=function(n,a){var t=e(n),i=t.offset().left,s=t.width(),o=function(e){return Math.floor((e-i)/s*100)},r=function(e){c.trigger({type:"scPlayer:onVolumeChange",volume:o(e.pageX)})};t.bind("mousemove.sc-player",r),r(a)},j=function(n){e(n).unbind("mousemove.sc-player")};e(document).on("mousedown",".sc-volume-slider",function(e){A(this,e)}).on("mouseup",".sc-volume-slider",function(e){j(this,e)}),c.bind("scPlayer:onVolumeChange",function(n){e("span.sc-volume-status").css({width:n.volume+"%"})}),e(function(){e.isFunction(e.scPlayer.defaults.onDomReady)&&e.scPlayer.defaults.onDomReady()})}(jQuery);